FROM quay.io/fedora/fedora-kinoite:42

RUN dnf install -y alacritty black clang cmake codespell distrobox dnf4 \
      fedora-workstation-repositories gcc hyperfine keepassxc libcurl-devel \
      make nvtop python3-tqdm qemu-kvm the_silver_searcher vim python3-flake8 \
      bats httpd-tools ninja meson python3-jinja2 SDL2-devel crun-krun podman
RUN dnf remove -y nano

# chrome
RUN rm -rf /opt && mkdir /opt
RUN dnf install -y --enablerepo="google-chrome" google-chrome-stable

# docker
RUN curl -fsSL https://get.docker.com | bash
RUN sed -i "s#/usr/bin/dockerd#/usr/bin/dockerd --ip-forward-no-drop#g" \
      /usr/lib/systemd/system/docker.service 

# ollama
# RUN dnf install -y ollama
COPY install.sh install.sh
RUN ./install.sh

# llama.cpp
RUN dnf install -y rocm-core-devel hipblas-devel rocblas-devel rocm-hip-devel

COPY build-llamacpp.sh build-llamacpp.sh
RUN ./build-llamacpp.sh

RUN bootc container lint

